{% extends 'base.html' %}
{% import 'macros.html' as macros with context %}

{% block head_title %}notebook {{ g.config['NOTEBOOK_TITLE'] }}{% endblock %}
{% block body_title %}
<span class="text-muted">notebook</span>
{{ g.config['NOTEBOOK_TITLE'] }}
{% endblock %}

{% block navmenu %}
<li class="nav-item dropdown">
  <a href="#" id="actionsDropdown"
     role="button" data-bs-toggle="dropdown"
     class="nav-link dropdown-toggle active me-3"
     aria-expanded="false">Actions</a>
  <ul class="dropdown-menu" aria-labelledby="actionsDropdown">
    <li>
      <a href="{{ url_for('edit', path='') }}"
         class="dropdown-item">Edit</a>
    </li>
    <li>
      <a href="{{ url_for('create') }}"
         class="dropdown-item"
         title="Create a new note.">Create note</a>
    </li>
    <li>
      <a href="{{ url_for('create', upload=True) }}"
         class="dropdown-item"
         title="Upload a file into a new note.">Upload file</a>
    </li>
  </ul>
</li>
{% endblock %} {# block navbar #}

{% block meta %}
<small>{{ root.modified | localtime }}</small>
{% endblock %}

{% block left %}
<div class="card mb-3">
  <div class="card card-header">In this notebook</div>
  <ul class="list-group list-group-flush">
    <li class="list-group-item list-group-item-light">
      {{ root.count_traverse() }} notes
    </li>
    <li class="list-group-item list-group-item-light">
      {{ n_links }} links
    </li>
  </ul>
</div>
<div class="card mb-3">
  <div class="card card-header text-white bg-dark">Notebooks</div>
  <ul class="list-group list-group-flush">
    {% for title, path in notebooks %}
    {% if title == g.config['NOTEBOOK_TITLE'] %}
    <li class="list-group-item">
      <a href="{{ url_for('notebook', title=title) }}"
         title="{{ path }}" class="text-decoration-none fw-bold">{{ title }}</a>
    </li>
    {% else %}
    <li class="list-group-item">
      <a href="{{ url_for('switch_notebook', title=title) }}"
         title="{{ path }}" class="text-decoration-none">{{ title }}</a>
    </li>
    {% endif %}
    {% endfor %}
  </ul>
</div>
<a href="{{ url_for('notebook') }}"
   class="btn btn-outline-dark d-grid"
   title="Add an existing directory as notebook.">Add new notebook</a>
<form action="{{ url_for('notebook') }}"
      method="POST">
  {{ get_csrf_token() }}
  <input type="hidden" name="_http_method" value="DELETE">
  <div class="d-grid mt-3">
    <button type="submit" class="btn btn-outline-danger small"
            onclick="return confirm('Remove will NOT delete the directory itself.')"
            >
      Remove this notebook</button>
  </div>
</form>  
{% endblock %} {# block left #}

{% block main %}
{{ root.text | markdown }}
<div class="card">
  <div class="card-header">Subnotes</div>
  <div class="card-body">
    {{ macros.noteslist(root.subnotes, 3) }}
  </div>
</div>
{% endblock %} {# block main #}

{% block right %}
<a href="{{ url_for('edit', path='') }}"
   role="button" class="btn btn-primary d-grid mb-3">Edit</a>
{% include 'starred.html' %}
{% include 'recent.html' %}
{% endblock %} {# block right #}

{% block javascript %}
{% include 'clipboard.html' %}
{% endblock %}
